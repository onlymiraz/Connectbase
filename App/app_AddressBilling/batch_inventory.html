<!-- /App/app_AddressBilling/batch_inventory.html -->
{% extends "base.html" %}
{% block title %}Address Billing - Batch Inventory{% endblock %}

{% block content %}
<div class="container mt-4">
  <h1>Address Billing - Batch Inventory</h1>
  <hr />

  <!-- Filters, if any: e.g. filter_batch_id, filter_user_email, etc. -->
  <form id="filterForm" method="GET" class="row g-3 align-items-center mb-3">
    <div class="col-auto">
      <label for="filter_batch_id" class="col-form-label">Batch ID:</label>
    </div>
    <div class="col-auto">
      <input 
        type="text" 
        class="form-control"
        id="filter_batch_id"
        name="filter_batch_id"
        value="{{ filters['filter_batch_id'] if filters.get('filter_batch_id') }}"
        placeholder="Batch ID contains..."
      />
    </div>
    <!-- etc for filter_user_email, filter_status, etc. -->

    <div class="col-auto">
      <button type="submit" class="btn btn-primary">
        Apply Filters
      </button>
    </div>
  </form>

  <!-- Export button passing existing filters -->
  <div class="mb-3">
    <a class="btn btn-success"
       href="{{ url_for('batch_inventory_export', **filters) }}">
      Export to Excel
    </a>
  </div>

  <div class="table-responsive">
    <table class="table table-striped table-hover">
      <thead>
        {% if df|length > 0 %}
        <tr>
          {% for col in df[0].keys() %}
          <th>{{ col }}</th>
          {% endfor %}
          <th>Actions</th>
        </tr>
        {% else %}
        <tr><th>No Data</th></tr>
        {% endif %}
      </thead>
      <tbody>
      {% for row in df %}
        <tr>
          {% for col in row.keys() %}
            <td>{{ row[col] }}</td>
          {% endfor %}
          <td>
            <a class="btn btn-sm btn-info"
               href="{{ url_for('show_fuzzymatch_results', batch_id=row['batch_id']) }}">
               Fuzzymatch
            </a>
            <a class="btn btn-sm btn-secondary"
               href="{{ url_for('batch_inventory_view_data', batch_id=row['batch_id']) }}">
               Raw Data
            </a>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Simple pagination controls -->
  <nav aria-label="Pagination">
    <ul class="pagination">
      {% if has_prev %}
      <li class="page-item">
        <a class="page-link"
           href="{{ url_for('batch_inventory', page=page-1, **filters) }}">
           Previous
        </a>
      </li>
      {% endif %}

      <li class="page-item disabled">
        <span class="page-link">
          Page {{ page }} | Total Pages: {{ total_pages }}
        </span>
      </li>

      {% if has_next %}
      <li class="page-item">
        <a class="page-link"
           href="{{ url_for('batch_inventory', page=page+1, **filters) }}">
           Next
        </a>
      </li>
      {% endif %}
    </ul>
  </nav>
</div>
{% endblock %}
